import{S as a,s as e,A as t}from"./index-8fe229f6.js";const r=async(r,s,o,n=a.ADMIN_DATA)=>{var d,i,l;try{const a=localStorage.getItem(n);let d="";if(a){d=JSON.parse(a).token||""}const i=s.startsWith("/api/")?s:`/api/${s}`,l=`${t.BASE_URL}${i}`,u={headers:{Authorization:d?`Bearer ${d}`:"","Content-Type":"application/json"}};let c;return c="get"===r||"delete"===r?await e[r](l,u):await e[r](l,o,u),{data:c.data,error:null}}catch(u){if(u.response){if(400===u.response.status||500===u.response.status){if(u.response.data.fieldErrors){const a=u.response.data.fieldErrors;let e="Validation errors:";for(const[t,r]of Object.entries(a))e+=`\n- ${t}: ${r}`;return{data:null,error:e,fieldErrors:a}}if(u.response.data.details&&Array.isArray(u.response.data.details)){u.response.data.details.forEach(((a,e)=>{a.field}));const a={};u.response.data.details.forEach((e=>{e.field&&(a[e.field]=e.message||"Validation error")}));for(const[e,t]of Object.entries(a));return{data:null,error:u.response.data.message||"Validation failed",fieldErrors:a,details:u.response.data.details}}}if(404===u.response.status)return{data:null,error:`API endpoint not found (404): ${s}. The requested resource may have been moved or removed.`}}else u.request;return{data:null,error:(null==(i=null==(d=u.response)?void 0:d.data)?void 0:i.message)||`Request failed: ${u.message||"Unknown error"}`,statusCode:null==(l=u.response)?void 0:l.status}}},s={getExams:async()=>{try{const a=await r("get","/api/admin/exams");if(a.error)return a;let e={...a};return a.data&&!a.data.exams&&(Array.isArray(a.data)?e.data={exams:a.data}:a.data.data&&(Array.isArray(a.data.data)?e.data={exams:a.data.data}:a.data.data.exams&&Array.isArray(a.data.data.exams)&&(e.data={exams:a.data.data.exams}))),e}catch(a){return{data:null,error:a.message||"Failed to fetch exams"}}},createExam:a=>o.createExam(a),deleteExam:a=>r("delete",`/api/admin/exams/${a}`),getSections:()=>r("get","/api/admin/sections"),createSection:a=>r("post","/api/admin/sections",a),updateSection:(a,e)=>r("put",`/api/admin/sections/${a}`,e),deleteSection:a=>r("delete",`/api/admin/sections/${a}`)},o={createExam:async r=>{var s,o,n;try{const o=localStorage.getItem(a.ADMIN_DATA);let n="";if(o){n=JSON.parse(o).token||""}const d=await e.post(`${t.BASE_URL}/api/admin/exams`,r,{headers:{"Content-Type":"application/json",Authorization:n?`Bearer ${n}`:""}});if(201===d.status||200===d.status){const a=d.data;return a.success&&a.data?{data:a.data,error:null}:a.exam?{data:{exam:a.exam},error:null}:{data:a,error:null}}return{data:null,error:(null==(s=d.data)?void 0:s.message)||"Unknown error"}}catch(d){return{data:null,error:(null==(n=null==(o=d.response)?void 0:o.data)?void 0:n.message)||"Failed to create exam"}}},getExams:async()=>{var r,s;try{const r=localStorage.getItem(a.ADMIN_DATA);let s="";if(r){s=JSON.parse(r).token||""}return{data:(await e.get(`${t.BASE_URL}/api/admin/exams`,{headers:{Authorization:s?`Bearer ${s}`:""}})).data,error:null}}catch(o){return{data:{exams:[]},error:(null==(s=null==(r=o.response)?void 0:r.data)?void 0:s.message)||"Failed to fetch exams"}}},deleteExam:async r=>{var s,o;try{const s=localStorage.getItem(a.ADMIN_DATA);let o="";if(s){o=JSON.parse(s).token||""}return{data:(await e.delete(`${t.BASE_URL}/api/admin/exams/${r}`,{headers:{Authorization:o?`Bearer ${o}`:""}})).data,error:null}}catch(n){return{data:null,error:(null==(o=null==(s=n.response)?void 0:s.data)?void 0:o.message)||"Failed to delete exam"}}}};export{s as a};
